class Solution {
    // Function to detect cycle in a directed graph.
    public boolean isCyclic(int V, ArrayList<ArrayList<Integer>> adj) {
        // code here
        
      boolean[] visited = new boolean[V];
      
      boolean[] dfsvisited = new boolean[V];
      //it depecits that if a node visit in current cycle or not 
      //if it is visited in current cycle then there is cycle otherwise not
      
      Arrays.fill(visited, false);
      Arrays.fill(dfsvisited, false);
      
      for(int i =0;i<V;i++){
          if(visited[i] == false){
              if(detectCycle(adj, i, visited, dfsvisited) == true)
                  return true;
          }
      }
      
      return false;
  }
    
    static boolean detectCycle(ArrayList<ArrayList<Integer>> adj, int node,
    boolean[] visited, boolean[] dfsvisited){
        visited[node] = true;
        dfsvisited[node] = true;
        
        for(Integer adjNode : adj.get(node)){
            if(visited[adjNode] == false){
                if(detectCycle(adj, adjNode, visited, dfsvisited) == true)
                    return true;
            }
            else if(dfsvisited[adjNode] == true)
                 return true;
        }
        dfsvisited[node] = false;
        return false;
   }
    
}
